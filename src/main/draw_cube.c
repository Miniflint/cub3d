/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   draw_cube.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: sbars <sbars@student.42.fr>                +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2022/12/19 11:41:56 by sbars             #+#    #+#             */
/*   Updated: 2022/12/20 17:47:39 by sbars            ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "../../inc/cub3d.h"

/*
** 1. Create a new image with the size of the window 
** 2. Draw a column of the texture on the image for each pixel of the window width
** 3. Return the image with the texture drawn on it 
*/

void    draw_cubes(t_all   *all, int *col_size)
{
	t_data  *img;
	t_data  *tex;
	int     x;
	int test_array[] = {400,400,401,401,401,402,402,402,403,403,404,405,405,405,406,407,408,408,408,409,409,410,410,411,411,411,411,411,412,412,413,413,413,414,415,417,418,418,418,418,419,419,419,420,420,421,421,422,422,422,424,424,425,425,425,426,427,427,427,427,428,428,429,429,429,429,430,431,432,433,433,435,435,436,436,438,438,438,439,440,440,441,443,444,444,445,445,446,446,447,447,448,449,451,451,452,452,452,452,452,455,455,456,456,456,457,458,458,459,459,460,460,460,460,461,461,461,461,462,464,464,464,467,468,468,469,470,470,472,472,473,473,474,474,475,475,475,476,476,477,478,479,480,481,483,483,484,484,485,485,486,487,487,488,488,488,488,489,489,490,490,491,491,492,493,493,493,493,494,495,495,495,496,496,496,496,497,498,498,499,499,500,500,500,501,501,502,502,503,503,503,503,504,504,505,506,506,506,507,507,507,508,510,511,511,511,511,512,512,513,514,514,515,515,515,516,517,517,519,521,522,522,522,523,524,524,524,525,525,525,526,526,526,526,527,527,527,527,528,529,529,530,530,530,531,531,532,532,533,533,534,534,534,534,534,534,535,535,537,537,537,537,538,538,538,538,539,539,540,540,540,542,542,543,545,545,545,545,546,546,547,547,548,548,550,550,550,550,551,552,552,552,553,554,554,554,554,555,557,557,559,559,560,560,561,561,562,563,563,563,563,563,564,564,564,567,569,571,571,571,571,572,572,572,572,573,574,574,574,574,576,577,578,579,579,580,580,580,581,581,582,583,583,583,585,585,586,586,586,586,587,588,588,588,590,591,591,592,594,594,594,594,595,596,596,596,596,596,596,597,597,597,598,598,600,600,600,600,600,601,601,601,602,603,604,606,606,607,607,608,609,609,610,611,612,612,612,613,614,614,615,615,615,617,618,618,620,621,621,621,623,624,624,624,625,625,625,626,627,628,628,629,629,629,630,630,630,631,632,633,633,633,634,634,635,635,635,636,636,637,637,637,641,641,642,642,644,644,645,646,646,646,647,648,648,649,649,650,651,651,653,653,653,654,655,656,657,657,658,658,659,659,661,662,663,664,664,665,665,665,665,666,666,666,668,669,669,670,670,670,671,672,672,672,672,673,674,675,675,675,676,678,679,680,680,680,680,682,684,684,684,684,684,685,686,687,687,687,688,688,688,689,689,690,690,692,692,693,693,694,694,694,694,695,695,695,696,696,699,700,700,700,701,702,703,705,705,706,706,706,707,708,709,709,710,711,711,711,712,712,713,713,714,714,717,717,717,717,719,719,719,720,720,721,721,722,722,724,724,724,725,726,727,727,728,728,729,729,729,729,730,730,730,730,731,732,733,734,736,736,737,737,737,737,738,740,740,741,741,742,742,742,742,745,747,749,749,749,751,752,752,753,753,753,753,757,757,758,759,759,759,760,761,761,761,762,763,763,763,763,764,765,766,767,768,769,769,769,770,770,770,770,770,771,771,771,772,772,773,774,775,775,775,775,776,776,776,776,777,777,779,779,779,780,781,782,783,784,785,785,786,786,787,788,788,788,789,789,790,790,790,790,790,792,796,796,796,797,798,799,799,799,802,802,802,803,803,803,803,804,805,805,805,805,805,805,806,806,806,807,807,807,807,807,807,809,809,809,809,810,811,812,812,813,814,814,814,814,814,815,815,816,816,816,818,819,819,820,821,821,821,823,824,824,825,826,826,827,830,830,830,832,832,833,833,833,834,834,835,835,838,838,839,839,839,839,840,840,840,840,841,842,842,843,843,843,844,844,844,845,846,846,846,848,848,848,850,850,850,851,852,853,853,854,854,855,855,856,856,856,856,856,856,857,857,857,859,859,861,861,861,862,862,862,862,863,864,864,864,864,864,865,866,866,867,868,868,868,870,872,872,874,874,874,874,874,875,876,876,876,877,877,877,877,878,879,879,881,881,882,883,884,884,885,886,887,887,888,888,889,890,890,890,890,891,892,892,893,893,894,895,895,897,897,899,899,900,900,900,900,901,901,902,902,903,903,903,904,905,906,906,907,907,908,908,908,908,909,910,910,911,911,912,912,912,913,913,913,913,914,914,915,916,917,917,917,918,918,919,919,919,920,920,920,921,922,922,922,922,922,923,923,924,924,926,927,929,929,929,930,930,931,931,933,933,934,935,937,937,937,938,938,939,939,939,939,941,942,943,944,944,945,945,946,946,946,947,948,948,948,948,948,949,949,950,950,950,950,951,951,952,952,953,953,954,955,955,955,955,955,955,956,956,957,957,958,959,960,961,963,964,964,965,965,966,966,966,968,968,969,971,971,971,971,971,972,972,972,974,974,974,974,976,976,977,977,978,979,979,979,979,979,979,979,979,979,980,981,981,982,983,983,983,984,984,985,986,986,987,987,988,989,989,990,990,990,990,990,990,991,993,993,994,995,996,997,997,998,1000,1000};

	(void) col_size;
	img = __img_init(all->mlx.mlx, all->txtr.r_int[0], all->txtr.r_int[1]);
	if (!img)
	{
		printf("Error\n");
		return ;
	}
	tex = all->txtr.no_img;
	x = -1;
	while (++x < 1000)
		draw_column_texture(tex, img, x, test_array[x]);
	mlx_put_image_to_window(all->mlx.mlx, all->mlx.window, img->img, 100, 100);
}

int get_col_text_pixel(t_data *img, int x, int y)
{
	char    *dst;

	dst = img->addr + (y * img->line_length + x * (img->bits_per_pixel / 8));
	return (*(unsigned int *)dst);
}

void    draw_column_texture(t_data *src, t_data *dst, int x, int cube_height)
{
	int     tex_y;
	int		tex_x;
	int		dst_y;
	int		color;
	int		scale_step;
	int		i;
	t_all	*all;

	all = ft_get_all(NULL);
	// starts at first column pixel
	dst_y = (all->txtr.r_int[1] - cube_height) / 2;
	tex_y = 0;
	// temporary, the decimal remainder of the x or y value the raycast hit, should be multiplied by the texture width: tex_x = cube_ratio * src->width;
	tex_x = x;
	scale_step = src->height / cube_height;
	i = 0;
	while (i < cube_height)
	{
		color = get_col_text_pixel(src, tex_x, tex_y);
		// printf("color: %d", color);
		if (color != 0/* && dst_y < all->txtr.r_int[1] && x < all->txtr.r_int[0] - 1*/)
				my_mlx_pixel_put(dst, x, dst_y, color);
		else
				write(2, "went too far my friend\n", 24);
		i++;
		dst_y++;
		// tex_y += scale_step;
		tex_y++;
	}
}